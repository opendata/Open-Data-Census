function showInfo(){var a={al:"Alabama",ar:"Arkansas",az:"Arizona",ak:"Alaska",ca:"California",co:"Colorado",ct:"Connecticut",de:"Delaware",fl:"Florida",ga:"Georgia",hi:"Hawaii",id:"Idaho",il:"Illinois","in":"Indiana",ia:"Iowa",ks:"Kansas",ky:"Kentucky",la:"Louisiana",me:"Maine",md:"Maryland",ma:"Massachusetts",ms:"Mississippi",mi:"Michigan",mn:"Minnesota",mo:"Missouri",mt:"Montana",ne:"Nebraska",nv:"Nevada",nh:"New Hampshire",nj:"New Jersey",nm:"New Mexico",ny:"New York",nc:"North Carolina",nd:"North Dakota",oh:"Ohio",ok:"Oklahoma",or:"Oregon",pa:"Pennsylvania",pr:"Puerto Rico",ri:"Rhode Island",sc:"South Carolina",sd:"South Dakota",tn:"Tennessee",tx:"Texas",ut:"Utah",vt:"Vermont",va:"Virginia",wa:"Washington",dc:"Washington DC",wv:"West Virginia",wi:"Wisconsin",wy:"Wyoming"};rawData=window.placesData;var t={};for(var e in rawData){name=rawData[e].Name;for(var n in a)a[n]==name&&(abbreviation=n);t[abbreviation]=rawData[e].Score}var r={20:"#f7fbff",30:"#deebf7",40:"#c6dbef",50:"#9ecae1",60:"#6baed6",70:"#4292c6",80:"#2171b5",90:"#084594"},i={};for(var e in t)score=10*Math.floor(t[e]/10),score<20&&(score=20),i[e]=r[score];initMap(i,a);var o=Handlebars.compile($("#state-template").html());rawData=window.censusData;var s=_.chain(rawData).map(function(a){return a["Type of Data"]}).unique().value();setupDatatypes(s),reversed={};for(var e in a)reversed[a[e]]=e;a=reversed;_.chain(rawData).groupBy("State").map(function(e,n){var r={state:n,state_score:t[a[n]]+"%",state:e[0].State,stateHref:URI().filename("datasets.html").search({state:n}).toString(),datasets:[]};return _.each(s,function(a){var t=_.find(e,function(t){return t["Type of Data"]===a});if(t){var n={grade:t.Grade,score:t.Score,datasetHref:URI().filename("datasets.html").search({state:r.state,datatype:t["Type of Data"]})};for(var i in n)n[i]||(n[i]="DNE");r.datasets.push(n).toString()}}),r}).sortBy("state").each(function(a){var t=o(a);$("#states").append(t)}).value();$('[data-toggle="tooltip"]').tooltip()}function initMap(a,t){var e={"01":"al","02":"ak","04":"az","05":"ar","06":"ca","08":"co","09":"ct",10:"de",11:"dc",12:"fl",13:"ga",15:"hi",16:"id",17:"il",18:"in",19:"ia",20:"ks",21:"ky",22:"la",23:"me",24:"md",25:"ma",26:"mi",27:"mn",28:"ms",29:"mo",30:"mt",31:"ne",32:"nv",33:"nh",34:"nj",35:"nm",36:"ny",37:"nc",38:"nd",39:"oh",40:"ok",41:"or",42:"pa",44:"ri",45:"sc",46:"sd",47:"tn",48:"tx",49:"ut",50:"vt",51:"va",53:"wa",54:"wv",55:"wi",56:"wy",72:"pr"},n=d3.geoAlbersUsa().scale(1280).translate([480,300]),r=d3.geoPath().projection(n),i=d3.select("#vmap").append("svg").attr("viewBox","0 0 960 600").attr("preserveAspectRatio","xMidYMid meet");d3.json("/grid/data/us-states.json").then(function(n){i.append("g").selectAll("path").data(topojson.feature(n,n.objects.states).features).enter().append("path").attr("d",r).attr("class","state").style("fill",function(t){var n=e[String(t.id).padStart(2,"0")];return a[n]||"#eee"}).on("click",function(a,t){var n=e[String(t.id).padStart(2,"0")];n&&(window.location.href="/datasets.html?state="+n)}).append("title").text(function(a){var n=e[String(a.id).padStart(2,"0")]||"";return t[n]||n.toUpperCase()})})}function setupDatatypes(a){var t=_.chain(a).map(function(a){return{datatype:a,datatypeHref:URI().filename(a.replace(/ /g,"")+".html").toString()}}).unique().value(),e=Handlebars.compile($("#dataset-template").html()),n=e(t);$("#datasets").append(n)}$(document).ready(function(){showInfo(),$(".table-responsive").doubleScroll()});var rawData=[];